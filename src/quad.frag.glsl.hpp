static const char *g_shader_fragment_quad = ""
#if defined(USE_LD)
"quad.frag.glsl"
#else
"vec3 i=normalize(vec3(1,.7,-.3));"
"float n=smoothstep(7600,9000,e);"
"float D(float e,float t)"
"{"
"if(e>t)return(e-t)/(1-t);"
"return(-t+e)/t;"
"}"
"float h(vec2 o)"
"{"
"float e=D(texture(k,o).s,.33),t=1-abs(e);"
"return sign(e)*(1-t*t*t);"
"}"
"float p(vec3 t)"
"{"
"return normalize(texture(f,t).stp).s;"
"}"
"float F(vec3 t)"
"{"
"mat2 e=mat2(m);"
"vec2 o=e*(t.sp+t.t*vec2(0,.3));"
"return(h(o)+h(e*(o*5.1))*-.11)*max((1-abs(t.p)*49),0);"
"}"
"float C(vec3 t)"
"{"
"vec3 e=m*t;"
"return(p(e)+p(m*(e*2.2))*-.2)*max((1-abs(t.p)*.05),0);"
"}"
"float j(vec3 t)"
"{"
"float e=0,o=1,a=.9,v=.9;"
"for(int c=0;"
"c<11;"
"++c)t=m*t*a,e+=p(t)*o,o*=v;"
"return e;"
"}"
"float A(vec2 t,vec2 a)"
"{"
"vec2 e=vec2(1,0);"
"for(int c=0;"
"c<11;"
"++c)"
"{"
"float o=length(t);"
"if(o>4)return .5*log(o)*o/length(e);"
"e=vec2(t.s*e.s-t.t*e.t,t.s*e.t+t.t*e.s)*2,t=vec2(t.s*t.s-t.t*t.t,t.s*t.t*2)+a;"
"}"
"return -.1;"
"}"
"float c(int l,vec3 t)"
"{"
"if(l==0)"
"{"
"float o=t.t;"
"if(abs(o)<1)"
"{"
"vec3 c=vec3(0,e*.0001,0);"
"o+=normalize(texture(f,t.spp*.0044-c).stp-texture(f,t*.0033+c).stp).s*.05;"
"}"
"return o;"
"}"
"if(l==1)"
"{"
"float e=t.t*.11-t.p*.01-.5;"
"if(abs(t.t)<22)e+=F(t*.00022)*(.8+n*6)+C(t*.015-n*vec3(.0,.8,.0))*.033*mix(1.,t.t,n);"
"if(t.p>0)e-=sqrt(t.p)*.01;"
"return e-n*.5;"
"}"
"vec2 o=vec2(-180,-145)+smoothstep(4400,4600,e)*100+max(e-4600,0)*.06-max(e-6300,0)*.05;"
"float n=smoothstep(7450,7900,e)*.25,a=smoothstep(4400,4500,e)*10;"
"vec2 s=vec2(50,40);"
"if(e>4589)s=vec2(-30,50);"
"float f=smoothstep(o.s+30,o.s-20,t.p),v=clamp((t.p-o.s)/abs(o.t-o.s),0,1);"
"vec2 r=vec2(25*cos(.037*(t.p+e*.3))+9*cos(.043*(t.p+e*.3)),14*cos(.041*(t.p+e*.3))+7*cos(.051*(t.p+e*.3))),i=vec2(.44,0),c=t.st-s+mix((.25-n)*r,r,smoothstep(o.t-20,o.t-250,t.p)),m=normalize(c)*(vec2(.55,1)+smoothstep(7450,7900,e)*vec2(-.56-.55,-.5-1))*(1-cos(v*1.5708))*a;"
"return c=c+m,A(c/a,mix(mix(vec2(.25,0),i,v),mix(i,vec2(.45*cos(.089*t.p),.45*sin(.091*t.p)),f),f))*mix(a,.5,v)-min(o.t-t.p,0);"
"}"
"vec3 b(int t,vec3 e)"
"{"
"vec3 o=vec3(1,0,0);"
"return normalize(vec3(c(t,e+o.stt),c(t,e+o.tst),c(t,e+o.tts)));"
"}"
"vec3 q(int v,vec3 t,vec3 o)"
"{"
"for(int a=0;"
"a<11;"
"++a)"
"{"
"vec3 e=(o+t)*.5;"
"float l=c(v,e);"
"if(l<0)o=e;"
"else t=e;"
"}"
"return t;"
"}"
"float g(int t,vec3 o,vec3 a,out vec3 e,out vec3 l,out float s)"
"{"
"float v=c(t,a);"
"if(v<0)e=q(t,o,a),l=b(t,e),s=length(e-o);"
"return v;"
"}"
"float z(vec3 o)"
"{"
"float a=c(1,o)+.4,v=0,t=1,l=0;"
"while(l<1&&t>0)"
"{"
"float s=abs(a)+v*.01+.2;"
"v+=s;"
"vec3 v=o+s*i;"
"float e=c(1,v);"
"if(e<0)return 0;"
"if(e<.04)t=min(e/.04,t);"
"float t=e;"
"o=v,a=t,l+=.022;"
"}"
"return max(t,0);"
"}"
"float u(vec3 t,vec3 e,float o)"
"{"
"return t=normalize(t+texture(f,e*.1).stp*.03+texture(f,e*.2).stp*.05),.8+dot(i,t)*.2+pow(max(dot(i,reflect(v,t)),0),16)*o;"
"}"
"vec2 B(vec2 t)"
"{"
"return vec2(log(length(t)),atan(t.t,t.s));"
"}"
"vec3 E(vec2 c,vec2 a)"
"{"
"vec2 t=c+vec2(.1,-1.05),e=vec2(0);"
"for(int o=0;"
"o<55;"
"++o)"
"{"
"vec2 c=vec2(t.s,abs(t.t));"
"t=B(c+a),e+=t;"
"}"
"return vec3(mix(vec3(-.2,-.3,-.3),vec3(.9,.2,.1),pow(e.t*.01,1))+length(e.s)*.06);"
"}"
"void main()"
"{"
"vec3 l=x(),x=l,h;"
"float r=4,d,w=min(c(0,l),c(1,l)),a=0,m=1,t=0,y=0;"
"o=vec4(vec3(1.3,1.1,.9),max(dot(i,v),0));"
"while(y<1)"
"{"
"float i=abs(w)*1.05+t*.008;"
"vec3 e=l+i*v,s,n;"
"float f,v=g(1,l,e,s,n,f),p=c(0,e);"
"if(p<0)"
"{"
"if(a==0)"
"{"
"vec3 t=q(0,l,e);"
"h=b(0,t);"
"float o=length(t-l);"
"if(v>0||o<f)d=u(h,t,2),a+=length(e-t),m=z(t);"
"}"
"else a+=i;"
"if(a>=r)"
"{"
"t+=i-(a-r),a=r;"
"break;"
"}"
"}"
"if(v<0)"
"{"
"o=vec4(vec3(.36,.33,.3),u(n,s,.1));"
"if(a==0)m=z(s);"
"t+=f;"
"break;"
"}"
"float c=min(abs(p),abs(v));"
"v=g(2,l,e,s,n,f);"
"if(v<0)"
"{"
"o=vec4(vec3(.9,.4,.44),u(n,s,.5)),t+=f;"
"break;"
"}"
"l=e,w=min(c,abs(v)),t+=i;"
"if(t>444)break;"
"y+=.006;"
"}"
"if(a>.0)"
"{"
"vec4 t=vec4(vec3(.33,.43,.48),d);"
"o=mix(o-a*.05,t,a/r);"
"}"
"o.q*=.4+m*.6,t*=.005,t=mix(t,smoothstep(.0,1.,t),min(t,1.));"
"float p=smoothstep(770,6220,e)-smoothstep(6200,6400,e),c=1-p;"
"if(c>0&&p>0)"
"{"
"o.q*=smoothstep(-.7,-.3,-p);"
"float a=dot(normalize(v*vec3(1,.3,1)),normalize(vec3(.2,.2,-1))),e=smoothstep(.3+c,.7+c,a);"
"if(e>0)"
"{"
"vec3 l=E(v.st*.05*pow(a*2,sqrt(sqrt(c))*5+2),vec2(.67,-.2));"
"o=mix(o,vec4(l,1),e),t=mix(t,1.0001-t,e);"
"}"
"}"
"float u=o.q;"
"o=vec4(mix(o.stp*u,vec3(.6)+j(v*.1+x*.01+(x+v*t*100)*.0001)*.01,mix(t,0,pow(max(dot(i,v),0),7)))-cos(e*.3)*(smoothstep(2400,2450,e)*smoothstep(-2500,-2450,-e))*.1+n*mix(vec3(6),vec3(1,0,0),t),t);"
"}"
#endif
"";
